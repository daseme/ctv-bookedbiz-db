{% extends "base.html" %}

{% block title %}Edit {{ user.full_name }} - CTV Booked Biz{% endblock %}

{% block header_title %}Edit User{% endblock %}
{% block header_subtitle %}Update user account information{% endblock %}

{% block breadcrumb %}
<span class="breadcrumb-separator">›</span>
<span>Admin</span>
<span class="breadcrumb-separator">›</span>
<a href="{{ url_for('user_management.list_users') }}">User Management</a>
<span class="breadcrumb-separator">›</span>
<span class="breadcrumb-current">Edit User</span>
{% endblock %}

{% block content %}
<div class="user-form">
    <div style="max-width: 600px; margin: 0 auto;">
        <form method="POST" action="{{ url_for('user_management.edit_user', user_id=user.user_id) }}" 
              style="background: white; padding: 32px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            
            <div style="margin-bottom: 24px;">
                <label for="first_name" style="display: block; margin-bottom: 8px; font-weight: 500; color: #2d3748;">
                    First Name *
                </label>
                <input type="text" id="first_name" name="first_name" value="{{ user.first_name }}" required
                       style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 6px; 
                              font-size: 14px; transition: border-color 0.2s;"
                       onfocus="this.style.borderColor='var(--nord10)'" 
                       onblur="this.style.borderColor='#e2e8f0'">
            </div>

            <div style="margin-bottom: 24px;">
                <label for="last_name" style="display: block; margin-bottom: 8px; font-weight: 500; color: #2d3748;">
                    Last Name *
                </label>
                <input type="text" id="last_name" name="last_name" value="{{ user.last_name }}" required
                       style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 6px; 
                              font-size: 14px; transition: border-color 0.2s;"
                       onfocus="this.style.borderColor='var(--nord10)'" 
                       onblur="this.style.borderColor='#e2e8f0'">
            </div>

            <div style="margin-bottom: 24px;">
                <label for="email" style="display: block; margin-bottom: 8px; font-weight: 500; color: #2d3748;">
                    Email *
                </label>
                <input type="email" id="email" name="email" value="{{ user.email }}" required
                       style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 6px; 
                              font-size: 14px; transition: border-color 0.2s;"
                       onfocus="this.style.borderColor='var(--nord10)'" 
                       onblur="this.style.borderColor='#e2e8f0'">
            </div>

            <div style="margin-bottom: 24px;">
                <label for="password" style="display: block; margin-bottom: 8px; font-weight: 500; color: #2d3748;">
                    New Password (leave blank to keep current)
                </label>
                <input type="password" id="password" name="password" minlength="8"
                       placeholder="Enter new password (min 8 characters)"
                       style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 6px; 
                              font-size: 14px; transition: border-color 0.2s;"
                       onfocus="this.style.borderColor='var(--nord10)'" 
                       onblur="this.style.borderColor='#e2e8f0'">
                <div style="font-size: 12px; color: #718096; margin-top: 4px;">
                    Leave blank to keep the current password
                </div>
            </div>

            <div style="margin-bottom: 32px;">
                <label for="role" style="display: block; margin-bottom: 8px; font-weight: 500; color: #2d3748;">
                    Role *
                </label>
                <select id="role" name="role" required
                        style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 6px; 
                               font-size: 14px; background: white; transition: border-color 0.2s;"
                        onfocus="this.style.borderColor='var(--nord10)'" 
                        onblur="this.style.borderColor='#e2e8f0'">
                    {% for role in roles %}
                    <option value="{{ role.value }}" {% if role.value == user.role.value %}selected{% endif %}>
                        {{ role.display_name }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <div style="display: flex; gap: 12px; justify-content: flex-end;">
                <a href="{{ url_for('user_management.view_user', user_id=user.user_id) }}" 
                   style="padding: 10px 24px; background: #e2e8f0; color: #4a5568; border-radius: 6px; 
                          text-decoration: none; font-weight: 500; transition: all 0.2s;"
                   onmouseover="this.style.background='#cbd5e0'" 
                   onmouseout="this.style.background='#e2e8f0'">
                    Cancel
                </a>
                <button type="submit" 
                        style="padding: 10px 24px; background: linear-gradient(135deg, var(--nord10) 0%, var(--nord9) 100%); 
                               color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; 
                               transition: all 0.2s; box-shadow: 0 2px 4px rgba(94, 129, 172, 0.3);"
                        onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(94, 129, 172, 0.4)'"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(94, 129, 172, 0.3)'">
                    Save Changes
                </button>
            </div>
        </form>

        <!-- Danger Zone -->
        <div style="margin-top: 48px; padding-top: 32px; border-top: 2px solid #fed7d7;">
            <h3 style="color: var(--nord11); margin-bottom: 16px; font-size: 18px;">Danger Zone</h3>
            <div style="background: #fee2e2; padding: 16px; border-radius: 6px; display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <div style="font-weight: 600; color: #991b1b; margin-bottom: 4px;">Delete User</div>
                    <div style="font-size: 13px; color: #7f1d1d;">
                        Permanently delete this user account. This action cannot be undone.
                    </div>
                </div>
                <form method="POST" action="{{ url_for('user_management.delete_user', user_id=user.user_id) }}" 
                      style="margin: 0;"
                      onsubmit="return confirm('Are you sure you want to delete {{ user.full_name }}? This action cannot be undone.');">
                    <button type="submit" 
                            style="padding: 8px 20px; background: var(--nord11); color: white; border: none; 
                                   border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s;"
                            onmouseover="this.style.background='#dc2626'" 
                            onmouseout="this.style.background='var(--nord11)'">
                        Delete User
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
