<svg xmlns="http://www.w3.org/2000/svg" width="960" height="360" viewBox="0 0 960 360" font-family="Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif">
  <style>
    .stage-box {
      fill: #0f172a;
      stroke: #1e293b;
      stroke-width: 2;
      rx: 12;
    }
    .stage-title {
      font-size: 14px;
      font-weight: 600;
      fill: #38bdf8;
    }
    .stage-body {
      font-size: 12px;
      font-weight: 400;
      fill: #f8fafc;
    }
    .arrow {
      stroke: #475569;
      stroke-width: 2.5;
      marker-end: url(#arrowhead);
      fill: none;
    }
    .label {
      font-size: 11px;
      font-weight: 500;
      fill: #94a3b8;
    }
    .pill {
      fill: #1e293b;
      stroke: #334155;
      stroke-width: 1.5;
      rx: 6;
    }
    .pill-text {
      font-size: 11px;
      font-weight: 500;
      fill: #e2e8f0;
    }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L6,3 L0,6 Z" fill="#475569"/>
    </marker>
  </defs>

  <!-- Feature stage -->
  <rect class="stage-box" x="40" y="60" width="260" height="200" />
  <text class="stage-title" x="60" y="88">Feature Branch</text>
  <text class="stage-body" x="60" y="110">name: feat/&lt;owner&gt;/&lt;slug&gt;</text>
  <text class="stage-body" x="60" y="130">work locally on Pi or VS Code</text>
  <text class="stage-body" x="60" y="150">run: ruff check / ruff format</text>
  <text class="stage-body" x="60" y="170">commit + push</text>
  <text class="stage-body" x="60" y="190">open PR → dev</text>

  <!-- Dev stage -->
  <rect class="stage-box" x="350" y="60" width="260" height="200" />
  <text class="stage-title" x="370" y="88">dev branch</text>
  <text class="stage-body" x="370" y="110">merge PR from feat/*</text>
  <text class="stage-body" x="370" y="130">pull on Pi: <tspan font-weight="600">git pull --ff-only</tspan></text>
  <text class="stage-body" x="370" y="150">service: ctv-dev.service (:5100)</text>
  <text class="stage-body" x="370" y="170">env: .env.dev</text>
  <text class="stage-body" x="370" y="190">DB: production_dev.db</text>
  <text class="stage-body" x="370" y="210">if healthy → PR dev → main</text>

  <!-- Main stage -->
  <rect class="stage-box" x="660" y="60" width="260" height="200" />
  <text class="stage-title" x="680" y="88">main branch</text>
  <text class="stage-body" x="680" y="110">Squash merge from dev</text>
  <text class="stage-body" x="680" y="130">on prod box:</text>
  <text class="stage-body" x="700" y="150">git switch main</text>
  <text class="stage-body" x="700" y="170">git pull --ff-only</text>
  <text class="stage-body" x="700" y="190">restart prod service</text>
  <text class="stage-body" x="680" y="210">env: .env.prod / DB: production.db</text>

  <!-- Arrows -->
  <line class="arrow" x1="300" y1="160" x2="350" y2="160"/>
  <line class="arrow" x1="610" y1="160" x2="660" y2="160"/>

  <!-- Legend pills -->
  <rect class="pill" x="60" y="280" width="110" height="26" />
  <text class="pill-text" x="70" y="297">Pi dev service</text>

  <rect class="pill" x="200" y="280" width="170" height="26" />
  <text class="pill-text" x="210" y="297">:5100 / .env.dev / production_dev.db</text>

  <rect class="pill" x="400" y="280" width="200" height="26" />
  <text class="pill-text" x="410" y="297">main == production reality</text>

  <!-- Row labels under arrows -->
  <text class="label" x="305" y="150">PR → dev</text>
  <text class="label" x="615" y="150">PR dev → main</text>
</svg>